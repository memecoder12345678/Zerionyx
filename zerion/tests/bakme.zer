load "libs.file"
load "libs.sys"

folder_path = argv>2

if not exists(folder_path) do
    println("File Error: Folder does not exist")
    exit(1)
else
    set_dir(folder_path)
done

list_files = list_dir(folder_path)
err = catch(make_dir("backup"))
if not is_none(err>1) do
    println("File Error: Can not make backup folder")
    exit(1)
else
    set_dir("backup")
    for i = 0 to len(list_files) do
        file = list_files>i
        if is_file(file) do
            err = catch(copy(file, file + ".bak"))
            if is_none(err>1) do
                println("Backup created: " + file + ".bak")
            else
                println(err>1)
            done
        else
            println("Warning: subfolders not supported yet")
        done
    done
done
